(function(n){n.extend({bb_tooltip:function(t,i,r,u,f,e){var h={html:f,sanitize:!f,title:r,placement:u,trigger:e},o=n("#"+t),s;i===""?(o.data("bs.tooltip")&&o.tooltip("dispose"),o.tooltip(h)):i==="enable"?(o.data("bs.tooltip")&&o.tooltip("dispose"),o.tooltip(h),s=o.parents("form").find(".is-invalid:first"),s.prop("nodeName")==="INPUT"?s.prop("readonly")?s.trigger("focus"):s.focus():s.prop("nodeName")==="DIV"&&s.trigger("focus")):i==="dispose"?o.data("bs.tooltip")&&o.tooltip(i):(o.data("bs.tooltip")&&o.tooltip("dispose"),o.tooltip(h),o.tooltip(i))},bb_popover:function(t,i,r,u,f,e,o){var s=n("#"+t),h={html:e,sanitize:!1,title:r,content:u,placement:f,trigger:o};i===""?(s.data("bs.popover")&&s.popover("dispose"),s.popover(h)):i==="dispose"?s.data("bs.popover")&&s.popover(i):(s.data("bs.popover")||s.popover(h),s.popover(i))},bb_confirm:function(t){var r=n('[data-target="'+t+'"]'),i=n("#"+t);i.popover({toggle:"confirm",html:!0,sanitize:!1,content:r.find(".popover-body").html()});i.popover("show")},timePicker:function(t){return n(t).find(".time-spinner-item").height()},datetimePicker:function(t,i){var r=n(t),f=r.attr("data-placement")||"auto",u=r.find(".datetime-picker-input");if(i)u.popover(i);else{u.popover({toggle:"datetime-picker",placement:f,template:'<div class="popover popover-datetime" role="tooltip"><div class="arrow"><\/div><h3 class="popover-header"><\/h3><div class="popover-body"><\/div><\/div>'}).on("inserted.bs.popover",function(){var t=this.getAttribute("aria-describedby"),i;t&&(i=n("#"+t),i.find(".popover-body").append(r.find(".date-picker").removeClass("d-none")))}).on("hide.bs.popover",function(){var u=this.getAttribute("aria-describedby"),t,i;u&&(t=n("#"+u),i=t.find(".date-picker"),t.find(".popover-body").append(i.clone()),r.append(i.addClass("d-none")))});n(".datetime-picker-input-icon").on("click",function(t){if(!n(this).hasClass("disabled")){t.stopImmediatePropagation();var i=n(this).parents(".datetime-picker-bar").find(".datetime-picker-input");i.trigger("click")}});n(".disabled .cell").on("click",function(n){n.preventDefault();n.stopImmediatePropagation()})}},bb_datetimeRange:function(t,i){var r=n(t),f=r.attr("data-placement")||"auto",u=r.find(".datetime-range-bar");if(i)u.popover(i);else{u.popover({toggle:"datetime-range",placement:f,template:'<div class="popover popover-datetime-range" role="tooltip"><div class="arrow"><\/div><h3 class="popover-header"><\/h3><div class="popover-body"><\/div><\/div>'}).on("inserted.bs.popover",function(){var t=this.getAttribute("aria-describedby"),i;t&&(i=n("#"+t),i.find(".popover-body").append(r.find(".datetime-range-body").addClass("show")))}).on("hide.bs.popover",function(){var u=this.getAttribute("aria-describedby"),t,i;u&&(t=n("#"+u),i=t.find(".datetime-range-body"),t.find(".popover-body").append(i.clone()),r.append(i.removeClass("show")))});r.find(".is-clear").on("click",function(){u.popover("hide")})}},bb_tab:function(t){n(t).tab("active")},footer:function(t,i){var r=n(t),u=r.tooltip();r.on("click",function(t){t.preventDefault();n(i||window).scrollTop(0);u.tooltip("hide")})},bb_layout:function(t,i){n(".layout-header").find('[data-toggle="tooltip"]').tooltip();n(window).on("resize",function(){r()});var r=function(){var r=n(window).width();t.invokeMethodAsync(i,r)};r()},markdown:function(t,i){var o="bb_editor",u=n(t),f,e,r;if(i){if(r=u.data(o),r)return f=r[i](),console.log(f),f}else e=n.getUID(),u.attr("id",e),r=editormd(e,{saveHTMLToTextarea:!0,path:"/lib/"}),u.data(o,r)},bb_console_log:function(t){var u=n(t),i=u.find('[data-scroll="auto"]'),r;i.length>0&&(r=i.find(".console-window"),i.scrollTop(r.height()))},bb_multi_select:function(t,i,r){n(t).data("bb_multi_select",{obj:i,method:r})},bb_tree:function(t){var i=n(t);i.find(".tree-content").hover(function(){n(this).parent().addClass("hover")},function(){n(this).parent().removeClass("hover")})},bb_select:function(t){var i=n("#"+t),r=i.find("input.search-text");if(r.length>0)i.on("shown.bs.dropdown",function(){r.focus()})}});n(function(){n(document).on("inserted.bs.tooltip",".is-invalid",function(){n("#"+n(this).attr("aria-describedby")).addClass("is-invalid")});n.fn.popover.Constructor.prototype.isWithContent=function(){var n=this.config.toggle;return["","confirm","datetime-picker","datetime-range"].indexOf(n)||this.getTitle()||this._getContent()};var t=function(t){var i=null,r=t.parents(".popover"),u;return r.length>0&&(u=r.attr("id"),i=n('[aria-describedby="'+u+'"]')),i};n(document).on("click",function(i){var f=!0,r=n(i.target),e=t(r),u;e!=null&&(f=!1);f&&n('[data-toggle="confirm"][aria-describedby^="popover"]').popover("hide");r.parents(".popover-datetime.show").length===0&&n(".popover-datetime.show").each(function(){var t=this.getAttribute("id"),i;t&&(i=n('[aria-describedby="'+t+'"]'),r.attr("aria-describedby")!==t&&i.popover("hide"))});r.parents(".popover-datetime-range.show").length===0&&n(".popover-datetime-range.show").each(function(){var t=this.getAttribute("id"),i;t&&(i=n('[aria-describedby="'+t+'"]'),r.parents(".datetime-range-bar").attr("aria-describedby")!==t&&i.popover("hide"))});u=r.closest(".multi-select");n(".multi-select.show").each(function(){if(u.length===0||this!=u[0]){var t=n(this).data("bb_multi_select");t.obj.invokeMethodAsync(t.method)}})});n(document).on("click",".popover-confirm-buttons .btn",function(i){var r,u,f;i.stopPropagation();r=t(n(this));r!=null&&(r.popover("hide"),u=r.attr("id"),$ele=n('[data-target="'+u+'"]'),f=this.getAttribute("data-dismiss")==="confirm"?$ele.find(".popover-confirm-buttons .btn:first"):$ele.find(".popover-confirm-buttons .btn:last"),f.trigger("click"))})})})(jQuery);